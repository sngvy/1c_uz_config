
&НаСервере
Процедура ЗагрузитьНаСервере()
	Попытка
		Для НомерСтроки = 2 По ПолеИсходнойТаблицы.ВысотаТаблицы Цикл
			КодКонтрагента = ПолеИсходнойТаблицы.Область("R" + Формат(НомерСтроки, "ЧГ=") + "C" + Формат(Объект.КодКонтрагента, "ЧГ=")).Текст;	
			НомерДО = ПолеИсходнойТаблицы.Область("R" + Формат(НомерСтроки, "ЧГ=") + "C" + Формат(Объект.НомерДО, "ЧГ=")).Текст;
			Контрагент = Справочники.Контрагенты.НайтиПоРеквизиту("КодКонтрагента", КодКонтрагента);
			ДО = Справочники.ДолговыеОбязательства.НайтиПоРеквизиту("КодДО", НомерДО);
			Если Не Контрагент.Пустая() И Не ДО.Пустая() Тогда
				МенеджерЗаписи = РегистрыСведений.Поручительства.СоздатьМенеджерЗаписи();
				МенеджерЗаписи.ДолговоеОбязательство = ДО;
				МенеджерЗаписи.Поручитель = Контрагент;
				МенеджерЗаписи.Записать(Истина);
			Иначе 
				Сообщить("По строке № " + Строка(НомерСтроки) + " данные не найдены!");
			КонецЕсли;
		КонецЦикла;
		Сообщить("Загрузка поручителей завершена");
	Исключение
	КонецПопытки;
КонецПроцедуры

&НаКлиенте
Процедура Загрузить(Команда)
	ЗагрузитьНаСервере();
КонецПроцедуры
