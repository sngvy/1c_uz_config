
Перем ИмяСправочникаССП Экспорт ;
 
Процедура ЗагрузитьДанные(ПолеИсходнойТаблицы, ОтправлятьСообщенияОбОшибке) Экспорт
	НаборЗаписей = РегистрыСведений.ЗначенияИПЦ.СоздатьНаборЗаписей();
	НаборЗаписей.Отбор.Территория.Установить(ЭтотОбъект.Территория);
	
	Для НомерСтолбца = 2 По ПолеИсходнойТаблицы.ШиринаТаблицы Цикл
		стрГод = ПолеИсходнойТаблицы.Область("R" + Формат(1, "ЧГ=") + "C" + Формат(НомерСтолбца, "ЧГ=")).Текст;
		Для НомерСтроки = 2 По ПолеИсходнойТаблицы.ВысотаТаблицы Цикл
			стрМесяц = строка(НомерСтроки - 1); 
			Если стрДлина(стрМесяц) = 1 Тогда
				стрМесяц = "0" + стрМесяц;
			КонецЕсли;
			
			стрЗначение = ПолеИсходнойТаблицы.Область("R" + Формат(НомерСтроки, "ЧГ=") + "C" + Формат(НомерСтолбца, "ЧГ=")).Текст;
			Попытка
				ЗначениеИПЦ = Число(стрЗначение);
			Исключение
				ЗначениеИПЦ = 0;
			КонецПопытки;
			ПериодИПЦ = Дата(стрГод + стрМесяц + "01");
			
			Если ЗначениеИПЦ > 0 Тогда
				Запись = НаборЗаписей.Добавить();
				Запись.Территория = ЭтотОбъект.Территория;
				Запись.ПериодИПЦ = ПериодИПЦ;
				Запись.Значение = ЗначениеИПЦ;
			КонецЕсли;
		КонецЦикла;
	КонецЦикла;
	
	НаборЗаписей.Записать();
КонецПроцедуры
