
&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	//{{_КОНСТРУКТОР_ПЕЧАТИ(Печать)
	ТабДок = Новый ТабличныйДокумент;
	Печать(ТабДок, ПараметрКоманды);

	ТабДок.ОтображатьСетку = Ложь;
	ТабДок.Защита = Истина;
	ТабДок.ТолькоПросмотр = Ложь;
	ТабДок.ОтображатьЗаголовки = Ложь;	
	Shell = Новый COMОбъект("WScript.Shell");
	USERPROFILE = Shell.ExpandEnvironmentStrings("%USERPROFILE%");
	ПоказатьОповещениеПользователя("Документооборот",,"Файл сохранен в папку Документы",БиблиотекаКартинок.NC_ПодсистемаДокументооборот);
	// Очистить символы в текущей дате
	ТекДата1 = СтрЗаменить(ТекущаяДата(), ".", "");
	ТекДата2 = СтрЗаменить(ТекДата1, ":", "");
	ТекДата3 = СтрЗаменить(ТекДата2, " ", "");
	ТабДок.Записать(USERPROFILE + "\Documents\Платежное требование " + ТекДата3 + ".pdf", ТипФайлаТабличногоДокумента.PDF);
	//}}
КонецПроцедуры

&НаСервере
Процедура Печать(ТабДок, ПараметрКоманды)
	Документы.ПлатежноеТребование.Печать(ТабДок, ПараметрКоманды);
КонецПроцедуры
